# Utility Hunting Queries

Clicking on the name of the query will bring you to the file for it in this git repo.

***Or try them out right away in your M365 Security tenant:***

Click on the 'ðŸ”Ž' hotlink to plug the query right into your Advanced Hunting Query page

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA81YbW_bNhDm5wH7D9qHoA6Qxk22dEO2As2WdR2QLlnTYV8KFIokvyCS7Fpynezlv-_uuaNIyVQSe-s2CLZl8nj33HNHHsmhGZrInJvSZPQ7MyP6rs0E_xL6jU1OT0b9Y_quqHVK75EpqOca72P6F6PtxMzpOSMtCfVlZkFtc_qXk1xibjGWNVyT9MysmtEr2FvAZgwdMiImJFOSLGnUp-YTQspYc2pfUhujiwjvgiQKs0_vkXlDbWLjPcmwTrbK1hZAzHp_Uz_mGJngX7Wmdw7rE_TwL8suCe0EGFlPTH3iwV7DWenhTDCipJ7K47SktsJcKTvCdxtJtoYmM6nnqehidA4lI5iAU4lMCb9TcFEDZQJ57kvAUdlEs_Ywr-BVyDpHYU8jnT7Q2ojec_U6Jkmx-Baj2c5EW2p9y3q4YOnUi3DmIbYM2Ny6wvhrxEJytab_EfUtqW-EbEzBvlieQX9GrXNITQmn5N8IXsXAntN7BQv7nu1wtlkOl6QnBbpu_CbUVlNvZY6haYwoTIBwH3lTUOsJZeoSs8J_f2wu4VutMcypt0YPyxWwXQPL0LzU_JMs3TGH5on5WZFOwe3QvMJMY2QVsrFWuc_NU3Ok76ckO4LVVDX_gH_8ztyI1PuO5vXVQOQuvBXB6Wd2x6RTWk4QfcmnGD7skzTnUA7-Oas4w1548WQtc_B4hihOIfGMPkfm69aok2b-XjTZw3ID4nYGnjn_bN8xtft2XHsF5t0a8ELz_SfN9rbELj2M4nd8hyxxe6TPH_TJzA1iKTOuD3UNbDwbGd2gpaX7JBif3SNlnyHyY6Z-l5gfNcUh92aqneMP0RdiMdIYL7BOrnQmROYRYT2mteItsVTpfOV_j8C08CoVYkBtO-YXlbpoodpp5Hlu-dEIx3RP14wU3LOePrlHDZoDenY9VFItw-N2SeoxfWQMj3poHM5Izxir9-1_FIcUM3mJzLZVzVaDCjPLrjT_10gdmi83jpSM2SRSvyquKWnbPhoJKi5HZIr9T2Sekw8cCaufZ3x1B88rD8c27B7QOryZ5xLRMapCQetxDPwfg4N5y1Kqlvq5CMtvx8oXG7ISdXixVaL6KMy0bUWetX52-vBtx8_Tv8mPj5lr8o35Cjr_XbZ8y5szJyO34e-Qns34O9f98_arTZhbaf1T9068u_qAXVumXts9-vfUbisCS_LOxT_R8S6OT2C8kymwQ7u9Y821FSUcyc96q9SQPsJH6BQqu3RBIfGY42S6aHbnM-xvzhCfJcVPzimvUHEdqpWeZjIdFfcgtTywtg96Hgnt4AbwWWaB63WnRXe6GQGtzWW7N85w1rpt7LV3jD4y2SuGMnEdFefhk0CdXJe0VbJbT9v7YLfrcd6-AYLC87U7KpRLbY_6suF5sP6Fc-s-Le3KMWqtjf-sRrdmWI5eY8bMML-iwNnV3gLEzUzjbMgpxqnm57T3XuZKz-x8suOzfq73AOtZdKnn4bpnTkpeWZn2zN7D3JT9l4v9t8DL90cu-qMWg7K7KRucbd_DOC0idw4UbAtEaYxTzwEhuu_MuNfK00Sx1ibT-e702fuDq4A__r2EvYNIG2vOhwLRvYF8vx8ynlfOObXKblf0OqRdTaH5E9L9jWYQ-3Vr3jW3fbI-3R19Z_0UJwDuK_RmIsIdin-buIQVqRU-G3Z9HntcL5oML83dt2fdeTFtjbBx6MttXg-7ueyq_DuPmUGLpUrvMLJ7OXKr6Tr7uz0z5DV4kBsw9jfXbBOfZBV3GXalp3pXxx7Ol-WlgmQBH-WONOrU-e-a-0zhyd1vDtSP084NoFRP_7bxGeLuj_T3FT9SX1hTG0mfrkvzkta6Q3OEXVtIT7fGhPWE6pesQ918sexxbbZrl0jez0WK36SJ-fmajrui-LC73dKzk2k1lDt3h_gvzOAiDAIYAAA&timeRangeId=week) [AppLocker Policy Assistant](AppLockerPolicy.kusto)
- Identify top folder sub-paths that currently execute programs
- Useful for building your AppLocker policy

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA6VVTW_TQBCdMxL_werJlgIVHEEcUppCUJUgnIgDqqo02aSunDiynUJRfzxv3q63dmq3BLTy7mR2Pt7MzkyO5VgCGchIJti_gR6CPpMxqDGoQKYS8ybEGUH6M_gxpGPHsRoTakxwO8B5gv0cnO-gz3Gv8i_lBbTV21xmssF5JQa70nfkZrIGL8HvmZQ4M0plssR-jbMAV-_W0CukB-4Op5F8j2tAz6Cf0voCK-dd4SViYDp1dIbbQPryG9ZUrg8kimUHq6WTU-wp7krqGljNIXONXx_wLYDfIkjADeWHHGFdIDfva1EreiNbUG_knYs3p8eU8dpcpERdRVu4_CxwJtgNMSX8jMN1CuqWng3QbpCtjPx7IktoR3M6J_q69MhlrcdXymSFZaAzhvTUZbbwtrb4lckNuE9b-sg85g7rgx2bqy1zp7xL2Cr4xuET3iPvfw1vr6C9xUpZMd2ebOWE1A3c-lv8lR2Lt8vHa0_XdW1dPacZ8y0VW3Rwdqd7FW99la5ecr70CpFXchG1NKdfiWXtvHfp2QgecN1AImE2h436u_O1VmX7sY-22n_L2l-yO0uX56XrwRJ1rxGtcHtLXwFO7Ymdr3bF9JNyOWXb8qT9M4P8pZ8tYaNro0ZdVKuaA_XuH2MeVW8ydF24Ocje4_c61MLAT7N-Y5b9T5Rt9dCN654z9Rffy86iM-RHJ9WoUYW2kuacZqF88q9Yr98jfrZXdrW8RP8ws_ZRKO8LIrzCv43WaOp4XRls66f2buk9Wxl_ADEwGPJIBwAA&timeRangeId=week) [Identity Correlation](IdentityCorrelation.kusto)
- Enter any number or combination of the following fields:
    - Hostname
    - Username
    - EmailAddress
    - SID
    - AzureAccountID
- Query will fill in the fields you don't know for each unique identity and fetch each person's Job Title
- Only needs minimum of 1 value for any 1 field

### [ðŸ”Ž](https://security.microsoft.com/v2/advanced-hunting?query=H4sIAAAAAAAAA6VVa2vbQBDcz4X-BxEokcGPpqWFFlwIbtMG0pISQz-UUvyQbMeKrFhyHKeP397Z0Z1svWJDMZLPe7uzu7Nz5450xJG-TGUmMVa3shJPlrLBeiZjrENJsPLxePQYYXeAlUaEMoElgmUBu-7HxmtIHw8IDvZCvNfE9WFfSQBMjRsQ6wY7CXdjeSpPUFF9TWviOrBEwB4wTnP4rOEGqylsCXZjeUukCVASWFeoqY0q1asjp_IAyxLRu-uWXGUdh1gF2E24o343zJ1W2pFPiLGeE3kmL-S5fDWVplx15DNWI1YW4_Hhnfq9lNfyyqzfw9dn1rFB_shfHrkJjNdtAblXmELqdYq-I8Ro1gFrU-5j9L0hzwH51Yx39PHkMje7D7Cn_aeT-E3Gp8zscSYzTktZULwItnd4BqhgIa6coIdGZeQZIgOsvph5O9KVv3gfl3TRxu97PMcZTqqva9hG1M22d1uPolVV14R1t9tz1Ke2b8x5luXsURU635BqUrQ8M3mPC6OPZq6afMR5hqT9JPTS-l05gs6UOVe-Y2YteSM_5Be4a0ITf8DfEXFP-D6kigb8LFfX8JjxvM35PWYFukoV5RjFKM-xqUoVPYFCuuxihVn4nJVzoFLsCS8yXaWDfWyVmU937GSqFDjk_bHmKQ3Jq70ZEuP9E7_H-LhQle5t8N0E88pxWU3KZxufKqU1alTZgt-ayA5O4Sg7e31YIvjURS1Zsz0T-c6v2OMS76quqxVv88SYY6oUvTMeStPcdpbe113e7Atzp7noU9V3YW68Mg_FSjTTPeKq2RySl-IdUDyd1r7tYcHubXx9_Y913QdKwpu0quc0wn0EW5lQfKfms8XfxbD44xyrVd3uw6-urJeh2kza9ZxaD_i_qfki3jnzmsxF_ot976usrI5LnvNdzP-p7RD1NcyJrKuxWnl1CqvTyj8EhP5NJgkAAA&timeRangeId=week) [Top Apps Crashing](TopAppsCrashing.kusto)
- Finds alls apps that have crashed in the last 7 days and sorts them by total number of crashes
- Includes total number of devices with crashes
- Includes list of devices for each app along with:
    - number of crashes on that device
    - last crash timestamp
